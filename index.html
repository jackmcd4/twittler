<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" href="stylesheet.css">
    <meta charset="utf-8">
    <title>Twittler</title>
  </head>
 
  <body>
    <h1 class= "title">Twittler</h1>
    <p>Welcome to Twittler!</p>
    <p id="userNamePrompt" class="bold">What's your username @ </p>
    <input id='inputField' type='text'></input>
     <p id="listLength">Display 
            <select>
              <option value="5">5</option>
              <option value="10" selected>10</option>
              <option value="20">20</option>
              <option value="30">30</option>
              <option value="50">50</option>
              <option value="all">All</option>
            </select> Most Recent Tweets
          </p>
    <p>Check out or <button class="title">update</button> your feed:</p>

    <script>
      $(document).ready(function(){
        var $body = $('body');
        var $section = $('section');
        var timeStamp;
       // $body.html('');
      


       var feed = function(){//first instant feed
        $section.html('');
        var index = streams.home.length - 1;
        var feedLength=0;
        while(0<=index){
        var tweet = streams.home[index];
        var $tweet = $('<div></div>');
        $tweet.text('@' + tweet.user + ': ' + tweet.message +" "+ timeSince(tweet.created_at)).appendTo($section);//should show correct time
          index--;
          feedLength++;
        }
      }
      feed();


     $(".title").on('click', function(){//should refresh page adding new tweets
          $section.html('');
          var index = streams.home.length - 1;
        var feedLength=0;
        var len = $('#listLength').find('select').val();
        if(len>index || len==='all'){
          len=index;
        }
        while(feedLength<=len){
        var tweet = streams.home[index];
        var $tweet = $('<div></div>');
        $tweet.text('@' + tweet.user + ': ' + tweet.message +" "+ timeSince(tweet.created_at)).appendTo($section);//should show correct time
          index--;
          feedLength++;
        }
     })




      var $aside = $('aside');//Menu sidebar with Users
     // $aside.html('');
     // var $ul = $('aside ul')
      //var ran = false;
     // $('.list').on('click', function(){//should toggle between showing on click
       //$('li').slideToggle();
        //if(ran===false){
          for(var i=0; i<users.length; i++){
            var tweetUser = users;
            var $tweetUser = $('<div class= alpha'+i+'></div>');
            $tweetUser.text(tweetUser[i]).appendTo($aside);
          } 
         // ran=true;
        
     // });
      $('.alpha0').on('click', function(e){
        //var $here = $('<div>"Hello"</div>').appendTo($body);
        $section.html('');
        var names = $(e.target);
        var person = streams.users.shawndrost;
        for(var i=person.length-1; i>=0; i--){
          var tweet = person[i];
          var $tweet = $('<div></div>');
          $tweet.text('@' + tweet.user + ': ' + tweet.message + " "+ timeSince(tweet.created_at)).appendTo($section);
        }
      });
       $('.alpha1').on('click', function(){
        //var $here = $('<div>"Hello"</div>').appendTo($body);
        $section.html('');
        var person = streams.users.sharksforcheap;
        for(var i=person.length-1; i>=0; i--){
          var tweet = person[i];
          var $tweet = $('<div></div>');
          $tweet.text('@' + tweet.user + ': ' + tweet.message + " "+ timeSince(tweet.created_at)).appendTo($section);
        }
      }); $('.alpha2').on('click', function(){
        //var $here = $('<div>"Hello"</div>').appendTo($body);
        $section.html('');
        var person = streams.users.mracus;
        for(var i=person.length-1; i>=0; i--){
          var tweet = person[i];
          var $tweet = $('<div></div>');
          $tweet.text('@' + tweet.user + ': ' + tweet.message +" "+ timeSince(tweet.created_at)).appendTo($section);
        }
      }); $('.alpha3').on('click', function(){
        //var $here = $('<div>"Hello"</div>').appendTo($body);
        $section.html('');
        var person = streams.users.douglascalhoun;
        for(var i=person.length-1; i>=0; i--){
          var tweet = person[i];
          var $tweet = $('<div></div>');
          $tweet.text('@' + tweet.user + ': ' + tweet.message + " "+ timeSince(tweet.created_at)).appendTo($section);
        }
      });
    function timeSince(timeStamp) {//want to exchange for moment.js in future
    var now = new Date(),
      secondsPast = (now.getTime() - timeStamp.getTime()) / 1000;
    if(secondsPast < 60){
      return '('+ parseInt(secondsPast) + ' seconds ago)';
    }
    if(secondsPast < 3600){
      return '('+parseInt(secondsPast/60) + ' minutes ago)';
    }
    if(secondsPast <= 86400){
      return '('+parseInt(secondsPast/3600) + ' hours ago)';
    }
    if(secondsPast > 86400){
        day = timeStamp.getDate();
        month = timeStamp.toDateString().match(/ [a-zA-Z]*/)[0].replace(" ","");
        year = timeStamp.getFullYear() == now.getFullYear() ? "" :  " "+timeStamp.getFullYear();
        return day + " " + month + year;
    }
  }
     });
      
      //title to click/show other twittlers
      //lists other twittlers on click
      
      </script>
      <aside>
      <h3>Users</h3>
      <!--button class="list">Your Twittlers</button-->
    </aside>
      <section>
     </section>
  </body>
</html>
